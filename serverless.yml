service: adamrms
provider:
  name: aws
  runtime: provided.al2
  region: eu-west-1
  stage: prod
  apiGateway:
    binaryMediaTypes:
      - '*/*'
    environment:
      BREF_BINARY_RESPONSES: '1'
plugins:
  - ./vendor/bref/bref
  - serverless-dotenv-plugin
custom:
  dotenv:
    path: ./.env.aws
package:
  exclude:
    - node_modules/**
    - .jekyll-cache/**
    - cdnAssets/
    - AWSLambda/**
    - docker/**
    - docs/**
    - tests/**
    - .env
    - Dockerfile
    - docker-compose-yml
    - Readme.md
    - updater.sh
    - Procfile
    - html/admin/**
functions:
  app:
    name: ${opt:stage, self:provider.stage, 'dev'}-AdamRMS # optional, Deployed Lambda name
    description: AdamRMS Main Lambda
    memorySize: 1024 # memorySize for this specific function.
    reservedConcurrency: 5
    tags:
      project: adam-rms
    handler: html/AWSLambdaAPI/index.php
    timeout: 28 # in seconds (API Gateway has a timeout of 29 seconds)
    layers:
      - ${bref:layer.php-74-fpm}
    events:
      #- httpApi: '*'
      - http: 'ANY /'
      - http: 'ANY /{proxy+}'